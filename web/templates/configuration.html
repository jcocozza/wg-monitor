{{ template "header.html" .}}
<head>
    <title>{{ .interfaceName }} - WireGuard Monitor </title>
</head>
<body>
    <h2> {{ .interface.Name }}</h2>
    <table>
        <thead>
            <tr>
                <th>Public Key</th>
                <th>IPAddress</th>
                <th>Listen Port</th>
                <th>Data Info</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{{ .interface.PublicKey }}</td>
                <td>{{ .interface.IPAddress }}</td>
                <td>{{ .interface.ListeningPort }}</td>
                <td> ***** </td>
            </tr>
        </tbody>
    </table>

    <h4>Total Clients: {{ len .interface.Peers }}</h4>

    <div id="peers", class="grid-container">
        {{ range $index, $peer := .interface.Peers }}
        <div class="peer">
            <details>
                <summary>
                    <span id="{{ $peer.PublicKey }}-index" aria-busy="true">
                        Peer: {{ $index }}
                    </span>
                    <span id="{{ $peer.PublicKey }}-MetaStatus" class="peerStatus">
                        <span class="statusDot offline"></span>
                    </span><br>
                    <div class="transfer-info">
                        <div class="sent">
                            <span id="{{ $peer.PublicKey }}-sent">{{ $peer.Sent }}</span> <span style="color: purple;">&#8682;</span> 
                        </div>
                        <div class="recieved">
                            <span id="{{ $peer.PublicKey }}-recieved">{{ $peer.Recieved }}</span> <span style="color: blue;">&#8681;</span> 
                        </div>
                    </div>
                </summary>

                <div class="peer-info-container">
                    <div class="publickey">
                        Public Key: <span id="{{ $peer.PublicKey }}-publickey">{{ $peer.PublicKey }}</span>
                    </div>
                    <div class="latesthandshake">
                        Latest Handshake: <span id="{{ $peer.PublicKey }}-latesthandshake">{{ $peer.LatestHandshake }}</span>
                    </div>
                    <div class="endpoint">
                        Endpoint: <span id="{{ $peer.PublicKey }}-endpoint">{{ $peer.EndPoint }}</span>
                    </div>
                    <div class="allowedips">
                        Allowed IPs: <span id="{{ $peer.PublicKey }}-allowedips">{{ $peer.AllowedIPs }}</span>
                    </div>
                </div>
            </details>
        </div>
        {{ end }}
    </div>
    <input type="checkbox" role="switch" id="toggle-switch" onclick="toggleClass('grid-container', 'new-class', 'peers')">
    <label for="toggle-switch"> Row-Grid </label>
</body>

<script>
    /*
    document.addEventListener('DOMContentLoaded', function() {
        var interfaceName = document.getElementById("peerStatusButton").getAttribute("data-interface-name")
        //getPeerMetaStatus(interfaceName)
        setInterval(function(){getPeerMetaStatus("{{ .interface.Name }}");}, 5000);
    });*/
    document.addEventListener('DOMContentLoaded', function() {
        getPeerMetaStatus("{{ .interface.Name }}");
        setInterval(function(){getPeerMetaStatus("{{ .interface.Name }}");}, 5000);
    });
</script>

{{ template "footer.html" .}}